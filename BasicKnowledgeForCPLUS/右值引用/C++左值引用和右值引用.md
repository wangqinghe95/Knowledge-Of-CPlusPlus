# C++ 左值引用和右值引用

[左值右值](https://zhuanlan.zhihu.com/p/137662465)

# 左值、右值的概念
1. 左值是可以放在赋值号左边被赋值的值，左值必须在内存中有实体；具体的说就是变量，指针这些东西；
2. 右值是在赋值号右侧，赋给其他值的值，右值可以在内存中也可以在 CPU 寄存器中；
3. 一个对象当作左值时使用的是它的地址，而当作右值时，使用的是它的值。

---
# 右值引用
1. 右值引用作用
    + 为了支持移动操作（包括移动构造函数和移动复制函数），C++引入的一种新的引用类型，可以自由的接管右值引用的对象内容。
2. 右值绑定的对象
    + 右值绑定的对象是返回非引用类型的函数，产生右值的表达式（算术表达式、关系表达式、位、后置递增递减）。
3. 和左值引用的区别
    + 绑定的对象不同，左值绑定的是返回左值引用的函数，下标，解引用，前置递增递减；
    + 左值持久，右值短暂。右值只能绑定到临时对象，所引用的对象将要销毁或该对象没有其他用户；
    + 使用右值引用的代码可以自由的接管所引用对象的内容；

---

```
#include<iostream>
using namespace std;

template<typename T>
void fun(T&& t){
    cout << t << endl;
} 

int getInt(){
    return 8;
}

int main(){
    int a = 10;
    int &b = a; //b是左值引用
    //int &c = 10;    //错误， c是左值不能使用右值初始化
    int &&d = 10;   //正确，右值引用用右值初始化
    //int &&e = a;    //错误，e 是右值引用不能使用左值初始化
    const int& f = a;   //正确，左值常引用相当于万能型，可以用左值或者右值初始化
    const int& g = 10;  //正确，左值常引用相当于万能型，可以用左值或者右值初始化
    const int&& h = 10; //正确，右值常引用
    const int& a = h;  //正确；

    //int& i = getInt();  //错误， i 是左值引用，不能使用临时变量来初始化
    int&& j = getInt(); //正确，函数返回值是右值

    fun(10);    //此时fun函数的参数t是右值
    fun(a);     //此时fun函数的参数t是左值
    return 0;
}
```

# Example1:
```
int &&i = 1;
int b = 2;
i = b;
```
# 解释： 
1. i 绑定了右值1，说明初始化时右值引用一定要用一个右值表达式绑定
2. 绑定之后，可以用左值表达式修改右值引用的所引用临时对象的值；

---

# Example2：
```
int && temp = 0;
int && i = temp;
```
# 解释：
1. temp 是一个右值引用变量，变量是左值，因此 i 引用 temp 左值是非法的

---

# Example3：
```
int &&temp = 0;
int && i = 0;
i = tmep
```

# 解释：
1. 上述代码是合法的，取出 temp 所引用临时对象的值，在赋值给 i 所引用对象的值；

# 总结：
1. 右值引用，是对临时对象的一种引用，他在初始化时完成引用的，但是右值引用不代表引用临时对象后不能改变右值引用所引用对象的值，仍然可以在初始化后改变临时对象的值；
2. 对于引用类型，可以用于它所引用对象类型的可以用在的地方（可以当作普通变量），只不过用到的值都是它所引用的对象的值，它还可以用于移动构造或赋值函数的地方。