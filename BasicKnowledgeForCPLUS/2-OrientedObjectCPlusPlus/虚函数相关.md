# 虚函数相关

## 虚函数
+ 什么是虚函数：为了实现动态编联产生的，为了通过基类类型的指针指向不同的对象时，自动调用相应的、与基类同名的函数。
+ 虚函数需要在基类函数中加上 virtual 修饰符修饰，因为 virtual 会被隐式继承，所以子类中相同函数都是虚函数。当一个成员函数被声明为虚函数之后，其派生类中同名函数自动成为虚函数，在派生类中重新定义此函数时要求函数名，返回值类型，参数个数和类型全部与基类函数相同。

## 纯虚函数
+ 纯虚函数只是相当于一个接口名，没有函数体，使用 “=0” 来标识
+ 含有纯虚函数的类不能实例化；
+ 纯虚函数的函数指针也会被存到虚函数表中，由于纯虚函数没有具体的函数体，因此它在虚函数表中的值就是 0，而具有函数体的虚函数则是函数的具体地址；
+ 一个类中如果有纯虚函数的话，称其为抽象类，抽象类不能实例化对象，否则会报错。抽象类一般用于定义一些公有的方法。
+ 子类继承抽象类也必须实现其中的纯虚函数才能实例化对象。

## 虚函数表
+ 虚函数表的特征
    - 虚函数表是全局共享的元素，即全局只有一个，在编译时期构造完成；
    - 虚函数表类类似一个数组，类对象中存储 vptr 指针，指向虚函数表；
    - 虚函数表存储的是函数的地址，即虚函数表的元素是指向类成员函数的指针；而类中虚函数的个数在编译时期可以确定的，即虚函数表的大小可以在编译时期确定的；

+ 虚函数表存储位置
    - 虚函数表类似于类中静态成员变量，静态成员变量也是全局共享，大小确定；
    - C++ 中虚函数表位于只读数据段(.rodata)，也就是C++内存模型中常量区；而虚函数则位于代码(.text)，也就是C++内存模型中的代码区

+ 虚函数表指针 vptr 的初始化时间
    - 由于虚表指针 vptr 和虚函数密不可分，对于有虚函数或者继承于拥有虚函数的基类，对该类进行实例化时，在构造函数执行时会对虚表指针进行初始化，并且存在对象内存布局的最前面